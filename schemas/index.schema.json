{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://xtractxact.dev/schemas/index.schema.json",
  "title": "Vector Index Metadata Record (Chroma)",
  "description": "Metadata stored alongside each vector; embeddings are store-internal.",
  "type": "object",
  "additionalProperties": false,
  "required": ["chunk_id", "conv_id", "contact", "platform", "date_start", "date_end", "message_ids"],
  "properties": {
    "chunk_id": { "type": "string" },
    "conv_id": { "type": "string" },
    "contact": { "type": "string" },
    "platform": { "type": "string", "enum": ["imessage", "instagram", "whatsapp", "txt"] },
    "date_start": { "type": "string", "format": "date-time" },
    "date_end": { "type": "string", "format": "date-time" },
    "message_ids": { "type": "array", "items": { "type": "string" } },
    "window_method": { "type": "string", "enum": ["turns", "daily", "semantic", "fixed"] },
    "window_index": { "type": "integer", "minimum": 0 },
    "window_overlap": { "type": "integer", "minimum": 0 },
    "labels_coarse": { "type": "array", "items": { "type": "string" } },
    "labels_fine_local": { "type": "array", "items": { "type": "string" } },
    "enrichment": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "topic_label": { "type": ["string", "null"] },
        "stance": { "type": ["string", "null"] },
        "emotion_primary": { "type": ["string", "null"] },
        "influence_class": { "type": ["string", "null"] }
      }
    },
    "source": {
      "type": "object",
      "additionalProperties": false,
      "required": ["path", "collection"],
      "properties": {
        "path": { "type": "string" },
        "collection": { "type": "string" }
      }
    }
  }
}
